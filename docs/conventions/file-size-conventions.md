# –°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ñ–∞–π–ª–æ–≤ –∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-29  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** Active  

---

## üìã –ö—Ä–∞—Ç–∫–∞—è –≤—ã–∂–∏–º–∫–∞ (TL;DR)

| –ü—Ä–∞–≤–∏–ª–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| üíæ **–ë–î** | –í—Å–µ–≥–¥–∞ `bigint` –≤ –±–∞–π—Ç–∞—Ö |
| üî¢ **API** | –í—Å–µ–≥–¥–∞ —á–∏—Å–ª–∞ –≤ –±–∞–π—Ç–∞—Ö |
| üìä **UI** | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ frontend –∏–ª–∏ –≤ `*Human` –ø–æ–ª—è—Ö |
| üìõ **Naming** | `*Bytes`, `*Size` (–±–∞–π—Ç—ã), `*Human` (—Å—Ç—Ä–æ–∫–∞) |

---

## 1. –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –ü–æ—á–µ–º—É –±–∞–π—Ç—ã?

- **–¢–æ—á–Ω–æ—Å—Ç—å**: –ë–∞–π—Ç ‚Äî –∞—Ç–æ–º–∞—Ä–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞, –Ω–µ —Ç—Ä–µ–±—É—é—â–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω—è—Ç —Ä–∞–∑–º–µ—Ä—ã –≤ –±–∞–π—Ç–∞—Ö
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ª—é–±—ã–µ –µ–¥–∏–Ω–∏—Ü—ã
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**: –ö—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∞–≤–∏–ª–æ "–ë–∞–π—Ç –≤–µ–∑–¥–µ"

```
üì¶ –•—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí –ë–∞–π—Ç—ã (bigint)
     ‚Üì
üîÑ –ü–µ—Ä–µ–¥–∞—á–∞ ‚Üí –ë–∞–π—Ç—ã (number)
     ‚Üì
üì± –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (KB/MB/GB)
```

---

## 2. –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 2.1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL + Drizzle ORM)

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```typescript
export const report6406TaskFiles = pgTable('report_6406_task_files', {
  id: uuid('id').primaryKey().defaultRandom(),
  fileName: varchar('file_name', { length: 500 }).notNull(),
  
  /**
   * –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö.
   */
  fileSize: bigint('file_size', { mode: 'number' }).notNull(),
  
  createdAt: timestamp('created_at').notNull().defaultNow(),
});
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```typescript
// –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö:
fileSize: integer('file_size')  // ‚ùå integer —Å–ª–∏—à–∫–æ–º –º–∞–ª
fileSizeMb: bigint('file_size_mb')  // ‚ùå –Ω–µ –≤ –±–∞–π—Ç–∞—Ö
fileSize: varchar('file_size')  // ‚ùå —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –¢–∏–ø: `bigint('field_name', { mode: 'number' })`
- NOT NULL –¥–ª—è —Ñ–∞–π–ª–æ–≤ (—Ä–∞–∑–º–µ—Ä –≤—Å–µ–≥–¥–∞ –∏–∑–≤–µ—Å—Ç–µ–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è)
- NULL –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω
- DEFAULT 0 –¥–ª—è aggregated –ø–æ–ª–µ–π (totalSize –≤ –ø–∞–∫–µ—Ç–∞—Ö)

### 2.2. Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```typescript
export const TaskFileResponseSchema = z.object({
  id: z.string().uuid(),
  fileName: z.string().max(500),
  fileSize: z
    .number()
    .int()
    .min(0)
    .describe('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö')
    .openapi({
      example: 10485760,
      description: '–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö (10485760 = 10 MB)',
    }),
  status: z.enum(['pending', 'converting', 'completed', 'failed']),
  createdAt: z.string().datetime(),
});
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
- `.number().int()` ‚Äî —Ç–æ–ª—å–∫–æ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
- `.min(0)` ‚Äî —Ä–∞–∑–º–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
- `.describe()` ‚Äî —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º "–≤ –±–∞–π—Ç–∞—Ö"
- `.openapi()` ‚Äî –ø—Ä–∏–º–µ—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è Swagger

### 2.3. API Response

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```typescript
// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –≤ –±–∞–π—Ç–∞—Ö + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
interface TaskFileResponse {
  id: string;
  fileName: string;
  fileSize: number;          // –≤ –±–∞–π—Ç–∞—Ö –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
  fileSizeHuman?: string;    // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è UI
  status: string;
  createdAt: string;
}

// –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "fileName": "report.xlsx",
  "fileSize": 10485760,
  "fileSizeHuman": "10.00 MB",
  "status": "completed",
  "createdAt": "2026-01-29T10:00:00Z"
}
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```typescript
// –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö:
interface TaskFileResponse {
  fileSizeMb: number;        // ‚ùå –Ω–µ –≤ –±–∞–π—Ç–∞—Ö
  size: string;              // ‚ùå —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞
  fileSize: "10 MB";         // ‚ùå —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ UI
}
```

### 2.4. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:

```typescript
import { formatBytesFixed, formatBytes, parseBytes } from '@/utils/file-size-formatter';

// –î–ª—è API responses (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
const totalHuman = formatBytesFixed(1073741824);  // "1.00 GB"
const usedHuman = formatBytesFixed(524288000, 2); // "500.00 MB"

// –î–ª—è –ª–æ–≥–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
console.log(`File size: ${formatBytes(10485760)}`);  // "10 MB"

// –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑ —Å—Ç—Ä–æ–∫–∏
const bytes = parseBytes("1.5 GB");  // 1610612736
```

### 2.5. Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```yaml
fileSize:
  type: integer
  format: int64
  description: "–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö"
  minimum: 0
  example: 10485760

totalBytes:
  type: integer
  format: int64
  description: "–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –≤ –±–∞–π—Ç–∞—Ö"
  example: 1099511627776

totalHuman:
  type: string
  description: "–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ"
  example: "1.00 TB"
```

**–í–∞–∂–Ω–æ:**
- `type: integer` —Å `format: int64` (–¥–ª—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª)
- `description` —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
- `example` ‚Äî —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –±–∞–π—Ç–∞—Ö

---

## 3. –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 3.1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API

```typescript
interface TaskFile {
  id: string;
  fileName: string;
  fileSize: number;  // –í–°–ï–ì–î–ê –≤ –±–∞–π—Ç–∞—Ö
  status: string;
}

// API response
const response = await fetch('/api/v1/report-6406/tasks/{id}/files');
const data = await response.json();

// data.items[0].fileSize === 10485760 (–≤ –±–∞–π—Ç–∞—Ö!)
```

### 3.2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —É—Ç–∏–ª–∏—Ç–∞:**
```typescript
/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥
 * @param bytes - —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
 * @returns –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
 */
function formatFileSize(bytes: number): string {
  if (bytes === 0) return '0 Bytes';
  
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  
  return `${(bytes / Math.pow(k, i)).toFixed(2)} ${sizes[i]}`;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```tsx
// –í React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
function FileList({ files }: { files: TaskFile[] }) {
  return (
    <ul>
      {files.map(file => (
        <li key={file.id}>
          {file.fileName} ‚Äî {formatFileSize(file.fileSize)}
        </li>
      ))}
    </ul>
  );
}

// –†–µ–Ω–¥–µ—Ä:
// report.xlsx ‚Äî 10.00 MB
// data.csv ‚Äî 2.50 MB
```

### 3.3. –í—ã—á–∏—Å–ª–µ–Ω–∏—è —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏

```typescript
// –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ –±–∞–π—Ç–∞—Ö
const totalSize = files.reduce((sum, file) => sum + file.fileSize, 0);

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
const largFiles = files.filter(file => file.fileSize > 100 * 1024 * 1024); // > 100 MB

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
const MAX_FILE_SIZE = 5 * 1024 * 1024 * 1024; // 5 GB
if (file.fileSize > MAX_FILE_SIZE) {
  alert(`–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π: ${formatFileSize(file.fileSize)}`);
}
```

### 3.4. –†–∞–±–æ—Ç–∞ —Å *Human –ø–æ–ª—è–º–∏

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —É–∂–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è:

```typescript
interface StorageInfo {
  totalBytes: number;      // –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
  usedBytes: number;
  freeBytes: number;
  usedPercent: number;
  totalHuman: string;      // –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  usedHuman: string;
  freeHuman: string;
  warning: string | null;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
<div>
  <p>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: {storageInfo.usedHuman}</p>
  <p>–°–≤–æ–±–æ–¥–Ω–æ: {storageInfo.freeHuman}</p>
  <ProgressBar value={storageInfo.usedPercent} />
</div>
```

---

## 4. –°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—é

### 4.1. –°—É—Ñ—Ñ–∏–∫—Å—ã –ø–æ–ª–µ–π

| –°—É—Ñ—Ñ–∏–∫—Å | –¢–∏–ø | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|---------|-----|--------|--------|---------------|
| `*Bytes` | `number` | –ë–∞–π—Ç—ã | `1073741824` | –î–ª—è —Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π |
| `*Size` | `number` | –ë–∞–π—Ç—ã | `10485760` | Legacy/–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `*Bytes` |
| `*Human` | `string` | –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ | `"1.00 GB"` | –¢–æ–ª—å–∫–æ –¥–ª—è UI |
| `*Percent` | `number` | –ü—Ä–æ—Ü–µ–Ω—Ç—ã | `47.68` | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã |

### 4.2. –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö

**Storage API:**
```typescript
{
  totalBytes: 1099511627776,    // —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  usedBytes: 524288000000,
  freeBytes: 575223627776,
  totalHuman: "1.00 TB",        // –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  usedHuman: "488.28 GB",
  freeHuman: "535.72 GB",
  usedPercent: 47.68
}
```

**Task File:**
```typescript
{
  id: "uuid",
  fileName: "report.xlsx",
  fileSize: 10485760,           // –≤ –±–∞–π—Ç–∞—Ö
  fileSizeHuman: "10.00 MB",    // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  status: "completed"
}
```

**Package:**
```typescript
{
  id: "uuid",
  name: "Q1 Reports",
  tasksCount: 15,
  totalSize: 157286400,         // —Å—É–º–º–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –±–∞–π—Ç–∞—Ö
  totalSizeHuman: "150.00 MB",  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  createdAt: "2026-01-29T10:00:00Z"
}
```

---

## 5. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

### ‚ùå –û—à–∏–±–∫–∞ 1: –°–º–µ—à–∏–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è

```typescript
// –ü–õ–û–•–û
const fileSizeMb = 10;
const totalSizeGb = 1.5;

// –•–û–†–û–®–û
const fileSize = 10485760;      // 10 MB –≤ –±–∞–π—Ç–∞—Ö
const totalSize = 1610612736;   // 1.5 GB –≤ –±–∞–π—Ç–∞—Ö
```

### ‚ùå –û—à–∏–±–∫–∞ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ integer –≤–º–µ—Å—Ç–æ bigint

```sql
-- –ü–õ–û–•–û
CREATE TABLE files (
  file_size INTEGER  -- –º–∞–∫—Å–∏–º—É–º ~2 GB
);

-- –•–û–†–û–®–û
CREATE TABLE files (
  file_size BIGINT   -- –¥–æ ~9 Exabytes
);
```

### ‚ùå –û—à–∏–±–∫–∞ 3: –•—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –ë–î

```typescript
// –ü–õ–û–•–û
await db.insert(files).values({
  fileName: 'report.xlsx',
  fileSize: '10 MB',  // ‚ùå —Å—Ç—Ä–æ–∫–∞!
});

// –•–û–†–û–®–û
await db.insert(files).values({
  fileName: 'report.xlsx',
  fileSize: 10485760,  // ‚úÖ –±–∞–π—Ç—ã
});
```

### ‚ùå –û—à–∏–±–∫–∞ 4: –ü–æ—Ç–µ—Ä—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

```typescript
// –ü–õ–û–•–û
const fileSizeMb = 10.7;
const bytes = fileSizeMb * 1024 * 1024;  // –ø–æ—Ç–µ—Ä—è —Ç–æ—á–Ω–æ—Å—Ç–∏

// –•–û–†–û–®–û
const bytes = 11219763;  // —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
```

### ‚ùå –û—à–∏–±–∫–∞ 5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –≤ API

```yaml
# –ü–õ–û–•–û
fileSize:
  type: integer
  example: 10485760

# –•–û–†–û–®–û
fileSize:
  type: integer
  format: int64
  description: "–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö"
  minimum: 0
  example: 10485760
```

---

## 6. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã

### 6.1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–≤

```typescript
// utils/constants.ts
export const SIZE_UNITS = {
  BYTE: 1,
  KB: 1024,
  MB: 1024 * 1024,
  GB: 1024 * 1024 * 1024,
  TB: 1024 * 1024 * 1024 * 1024,
  PB: 1024 * 1024 * 1024 * 1024 * 1024,
} as const;

// –õ–∏–º–∏—Ç—ã
export const MAX_FILE_SIZE = 5 * SIZE_UNITS.GB;        // 5 GB
export const MAX_PACKAGE_SIZE = 100 * SIZE_UNITS.GB;   // 100 GB
export const MAX_STORAGE_SIZE = 10 * SIZE_UNITS.TB;    // 10 TB

// –ü–æ—Ä–æ–≥–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
export const STORAGE_WARNING_THRESHOLD = 85;  // –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
export const LARGE_FILE_THRESHOLD = 100 * SIZE_UNITS.MB;  // 100 MB
```

### 6.2. –£—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Backend)

```typescript
// utils/file-size-formatter.ts

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ API responses
 */
export function formatBytesFixed(bytes: number, decimals: number = 2): string {
  if (bytes === 0) return '0 Bytes';
  
  const k = 1024;
  const dm = decimals < 0 ? 0 : decimals;
  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
  
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  const value = bytes / Math.pow(k, i);
  
  return `${value.toFixed(dm)} ${sizes[i]}`;
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö
 */
export function formatBytes(bytes: number): string {
  if (bytes === 0) return '0 Bytes';

  const k = 1024;
  const dm = 2;
  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];

  const i = Math.floor(Math.log(bytes) / Math.log(k));

  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;
}

/**
 * –ü–∞—Ä—Å–∏—Ç—å —Å—Ç—Ä–æ–∫—É —Å —Ä–∞–∑–º–µ—Ä–æ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∞–π—Ç—ã
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö
 */
export function parseBytes(sizeStr: string): number {
  const units: Record<string, number> = {
    'B': 1,
    'BYTES': 1,
    'KB': 1024,
    'MB': 1024 * 1024,
    'GB': 1024 * 1024 * 1024,
    'TB': 1024 * 1024 * 1024 * 1024,
    'PB': 1024 * 1024 * 1024 * 1024 * 1024,
  };

  const match = sizeStr.trim().match(/^([\d.]+)\s*([A-Z]+)$/i);
  
  if (!match) {
    throw new Error(`Invalid size format: ${sizeStr}`);
  }

  const [, value, unit] = match;
  const multiplier = units[unit.toUpperCase()];

  if (!multiplier) {
    throw new Error(`Unknown unit: ${unit}`);
  }

  return Math.round(parseFloat(value) * multiplier);
}
```

---

## 7. –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### Backend Developer Checklist

- [ ] –í—Å–µ –ø–æ–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `bigint` –≤ –ë–î
- [ ] –í—Å–µ –ø–æ–ª—è –∏–º–µ—é—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ "–≤ –±–∞–π—Ç–∞—Ö"
- [ ] Zod —Å—Ö–µ–º—ã –≤–∫–ª—é—á–∞—é—Ç `.describe()` –∏ `.openapi()`
- [ ] API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –±–∞–π—Ç–∞—Ö
- [ ] Swagger —Å–æ–¥–µ—Ä–∂–∏—Ç `format: int64` –∏ –ø—Ä–∏–º–µ—Ä—ã
- [ ] –£—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è `*Human` –ø–æ–ª–µ–π
- [ ] –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SUM()` –∏ `COALESCE(..., 0)`
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç —É—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Frontend Developer Checklist

- [ ] –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑ API –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –±–∞–π—Ç—ã
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è UI
- [ ] –í—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –±–∞–π—Ç–∞—Ö
- [ ] `*Human` –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `SIZE_UNITS`
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –±–∞–π—Ç–∞—Ö (–Ω–µ –≤ MB/GB)

---

## 8. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [TASK-008: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞—á–∏ —Ä–∞–∑–º–µ—Ä–æ–≤](../tasks/TASK-008-standardize-size-storage-and-api.md)
- [API Conventions](../api-conventions.md)
- [Database Schema](../../service2110/src/db/schema/)
- [File Size Formatter Utils](../../service2110/src/utils/file-size-formatter.ts)

---

## 9. FAQ

### Q: –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –±–∞–π—Ç—ã, –∞ –Ω–µ –∫–∏–ª–æ–±–∞–π—Ç—ã –∏–ª–∏ –º–µ–≥–∞–±–∞–π—Ç—ã?

**A:** –ë–∞–π—Ç ‚Äî —ç—Ç–æ –∞—Ç–æ–º–∞—Ä–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è. –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö (KB, MB) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–±–ª–µ–º–∞–º —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π. –§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ç–∞–∫–∂–µ –æ–ø–µ—Ä–∏—Ä—É—é—Ç –±–∞–π—Ç–∞–º–∏.

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω?

**A:** 
- –î–ª—è —Ñ–∞–π–ª–æ–≤: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `NULL` –≤ –ë–î, –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `0` –≤ API
- –î–ª—è –ø–∞–∫–µ—Ç–æ–≤: –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `0` (–ø—É—Å—Ç–æ–π –ø–∞–∫–µ—Ç = 0 –±–∞–π—Ç)

### Q: –ù—É–∂–Ω–æ –ª–∏ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `*Human` –ø–æ–ª—è?

**A:** –ù–µ—Ç, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ —É–ª—É—á—à–∞–µ—Ç UX. –û–±—ã—á–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –ª—É—á—à–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ frontend –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `number` –≤–º–µ—Å—Ç–æ `bigint`?

**A:** –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ä–∞–∑–º–µ—Ä—ã –Ω–µ –ø—Ä–µ–≤—ã—Å—è—Ç `Number.MAX_SAFE_INTEGER` (9 petabytes). –î–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigint`.

### Q: –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (> 1 TB)?

**A:** `bigint` —Å `{ mode: 'number' }` –≤ Drizzle –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ 9 Exabytes. –≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ª—é–±—ã—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-29  
**–ê–≤—Ç–æ—Ä—ã:** Development Team  
**–°—Ç–∞—Ç—É—Å:** Active
