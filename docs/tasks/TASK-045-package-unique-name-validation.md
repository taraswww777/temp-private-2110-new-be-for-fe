# TASK-045: Валидация уникальности наименования пакета

**Статус**: ✅ Выполнено
**Ветка**: `feature/TASK-045-package-unique-name-validation`

---

## Краткое описание

Реализовать валидацию уникальности наименования пакета при создании и переименовании. При наличии дубликата возвращать ошибку на UI.

---

## Исходное описание задачи

> Данный раздел содержит оригинальное описание задачи для оперативного обращения.

**Источник:** [Замечания от 06.02.2026](https://github.com/taraswww777/temp-private-2110-new-be-for-fe/blob/feature/Masha/docs/Правки%20от%2006.02.md#6406)

### Создание и переименование пакета:
Наименование пакета должно быть уникальным. Если при создании или переименовании пакета бэкэнд вернет инфу, что такой пакет уже есть, то ошибка на UI.

---

## Цели

- Реализовать проверку уникальности наименования пакета на Backend
- Возвращать понятную ошибку при дубликате
- Обеспечить обработку ошибки на Frontend

---

## Детальное описание

### Контекст

При создании или переименовании пакета необходимо проверять уникальность его наименования. Если пакет с таким именем уже существует, должна возвращаться ошибка.

### Требования

#### Backend валидация

**Endpoints:**
- `POST /api/v1/report-6406/packages` - создание пакета
- `PUT /api/v1/report-6406/packages/:id` - переименование пакета

**Логика проверки:**
1. При создании: проверить, существует ли пакет с таким именем
2. При переименовании: проверить, существует ли другой пакет (не текущий) с таким именем
3. Если дубликат найден - вернуть ошибку 400 (Bad Request)

**Response при ошибке:**
```json
{
  "error": "PACKET_NAME_DUPLICATE",
  "message": "Пакет с таким наименованием уже существует",
  "details": {
    "name": "Название пакета",
    "existingPacketId": "uuid-существующего-пакета"
  }
}
```

#### Frontend обработка

- Отображать ошибку пользователю
- Показывать понятное сообщение об ошибке
- Возможно, подсветить поле с ошибкой

---

## Критерии приёмки

### Backend
- [x] Реализована проверка уникальности при создании пакета
- [x] Реализована проверка уникальности при переименовании пакета
- [x] При дубликате возвращается ошибка 400 с понятным сообщением
- [x] Ошибка содержит информацию о существующем пакете
- [x] Добавлены unit-тесты
- [x] Обновлена OpenAPI спецификация
- [x] Добавлено ограничение уникальности на уровне базы данных для поля name в таблице report6406_packages

### Frontend
- [ ] Ошибка валидации отображается пользователю
- [ ] Сообщение об ошибке понятно
- [ ] Поле с ошибкой подсвечено (если требуется)

> **Уточнение**: Согласно полученной информации, работа должна вестись только в сервисе service2110, изменения в frontend не требуются.

### Общие критерии
- [x] Все изменения протестированы
- [x] Обработка ошибок работает корректно

---

## Порядок выполнения

1. Проанализировать текущую структуру создания/переименования пакетов
2. Реализовать проверку уникальности на Backend
3. Добавить валидацию в endpoints
4. Обновить обработку ошибок на Frontend
5. Написать unit-тесты
6. Обновить OpenAPI спецификацию
7. Протестировать все сценарии
8. Добавить ограничение уникальности на уровне базы данных

---

## Связанные документы

- [Замечания от 06.02.2026](https://github.com/taraswww777/temp-private-2110-new-be-for-fe/blob/feature/Masha/docs/Правки%20от%2006.02.md)

---

