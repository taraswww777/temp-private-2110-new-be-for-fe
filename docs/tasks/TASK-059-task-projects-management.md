# TASK-059: Управление проектами для задач

**Статус**: ✅ Выполнено  
**Ветка**: `feature/TASK-059-task-projects-management`  
**Приоритет**: средний  
**Дата создания**: 2026-02-12  
**Дата завершения**: 2026-02-12  

---

## Краткое описание

Добавить возможность указывать проект, к которому относится задача. Выбор активного проекта должен производиться в шапке интерфейса рядом с логотипом "Task Viewer". Проекты хранятся аналогично тегам. Управление проектами осуществляется на отдельной странице.

---

## Контекст

В текущей версии Task Viewer отсутствует возможность группировки задач по проектам. Необходимо добавить механизм управления проектами, который позволит пользователям организовывать задачи по проектам и фильтровать их по выбранному активному проекту.

---

## Цели

- Добавить возможность указывать проект для каждой задачи.
- Реализовать выбор активного проекта в шапке интерфейса рядом с логотипом "Task Viewer".
- Обеспечить хранение списка проектов аналогично тегам.
- Ограничить выбор проекта только из заранее сформированного списка проектов.
- Создать отдельную страницу для управления проектами.
- Добавить инициальные проекты: "2110" и "TaskViewer".

---

## Критерии приёмки

- [x] В шапке интерфейса рядом с логотипом "Task Viewer" добавлен селектор для выбора активного проекта.
- [x] При создании/редактировании задачи можно указать проект из списка доступных проектов.
- [x] Проекты хранятся аналогично тегам (в отдельном файле/хранилище).
- [x] Выбор проекта возможен только из заранее сформированного списка (нельзя создать проект "на лету").
- [x] Создана отдельная страница для управления проектами (добавление, редактирование, удаление).
- [x] В системе присутствуют инициальные проекты: "2110" и "TaskViewer".
- [x] Фильтрация задач по выбранному активному проекту работает корректно.
- [x] Добавлен вариант "Без проекта" в селектор проекта для фильтрации задач без проекта.
- [x] Выбранный проект синхронизируется с URL параметром `project`.
- [x] Колонка "Проект" отображается в таблице задач при выборе "Все проекты".
- [x] Проект отображается рядом со статусом и приоритетом на детальной странице задачи.

---

## Технические заметки

- Хранение проектов: аналогично тегам (вероятно, в `taskViewerBe/test-tmp/` или отдельном JSON файле).
- Компонент выбора проекта в шапке: должен быть размещён рядом с логотипом "Task Viewer".
- Страница управления проектами: отдельный роут в приложении.
- Backend: необходимо добавить эндпоинты для работы с проектами (CRUD операции).
- Frontend: компоненты для отображения и управления проектами, интеграция с существующей системой задач.

---

## Уточнения и дополнения (реализовано)

### UI/UX улучшения

1. **Колонка "Проект" в таблице задач:**
   - Колонка "Проект" отображается в таблице задач только когда выбрано "Все проекты" (для возможности массового редактирования проектов).
   - Колонка "Ветка" удалена из таблицы задач для упрощения интерфейса.

2. **Селектор проекта в шапке:**
   - Добавлен вариант "Без проекта" для фильтрации задач без назначенного проекта.
   - Доступные варианты: "Все проекты", "Без проекта", и список всех проектов.

3. **Синхронизация с URL:**
   - Выбранный проект синхронизируется с GET-параметром `project` в адресной строке браузера.
   - Параметр сохраняется при навигации между страницами.
   - При загрузке страницы сначала проверяется URL, затем localStorage.

4. **Детальная страница задачи:**
   - Проект отображается рядом со статусом и приоритетом в заголовке карточки (в одной строке с селекторами).
   - При клике на ID задачи на детальной странице он копируется в буфер обмена (аналогично странице списка задач).

### Технические детали реализации

1. **Backend:**
   - Создан сервис `projects-metadata.service.ts` для управления проектами.
   - Файл `projects-metadata.json` создан в `docs/tasks/` с инициальными проектами.
   - Добавлены эндпоинты: `GET /api/projects`, `POST /api/projects`, `PATCH /api/projects/:id`, `DELETE /api/projects/:id`.
   - Поле `projectId` добавлено в типы задач (в манифесте хранится ID, в API резолвится в имя).

2. **Frontend:**
   - Создан контекст `ProjectContext` для управления выбранным проектом с синхронизацией URL и localStorage.
   - Компонент `ProjectSelector` размещён в шапке рядом с логотипом.
   - Страница `TaskProjectsPage` для управления проектами (CRUD операции).
   - Фильтрация задач реализована в `TasksListPage` с поддержкой варианта "Без проекта".
   - Выбор проекта добавлен в `TaskEditDialog` и `TaskDetailPage`.
