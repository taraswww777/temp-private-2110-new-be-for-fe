# TASK-003: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API –¥–ª—è —Ñ–æ—Ä–º—ã –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ 6406

## –°—Ç–∞—Ç—É—Å
üìã –ë—ç–∫–ª–æ–≥

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Backend API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–æ–π –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ 6406, –≤–∫–ª—é—á–∞—é—â–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤ –∏ –ø–∞–∫–µ—Ç–∞–º–∏ –∑–∞–¥–∞–Ω–∏–π. API –¥–æ–ª–∂–µ–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –∏ –ø–∞–∫–µ—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –∏—Ö —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ –º–µ–∂–¥—É —Å–æ–±–æ–π.

## –¶–µ–ª–∏
1. –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤ –∏ –ø–∞–∫–µ—Ç–æ–≤
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è–º–∏ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏ –∑–∞–¥–∞–Ω–∏–π
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π —Å –ø–∞–∫–µ—Ç–∞–º–∏
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (—Ñ–∏–ª–∏–∞–ª—ã, –≤–∞–ª—é—Ç—ã, —Ñ–æ—Ä–º–∞—Ç—ã, –∏—Å—Ç–æ—á–Ω–∏–∫–∏, —Ç–∏–ø—ã –æ—Ç—á—ë—Ç–æ–≤)
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
7. –û–±–µ—Å–ø–µ—á–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—ã
8. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –£—Å—Ç–∞—Ä–µ–≤—à–∞—è Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
–í –∫–∞—á–µ—Å—Ç–≤–µ —á–µ—Ä–Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª `docs/rawData/2026-01-27/reportService.json`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ä—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é API. **–í–∞–∂–Ω–æ**: —ç—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–∞ –Ω–∞ 100% –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –Ω–æ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö.

### UI —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã
–í –ø–∞–ø–∫–µ `docs/rawData/2026-01-27/` –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å–∫—Ä–∏–Ω—à–æ—Ç—ã UI —Ñ–æ—Ä–º—ã 6406, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ:
- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤
- –§–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
- –°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–∞–∫–µ—Ç–∞
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤ –ø–∞–∫–µ—Ç

## –°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ API

### –ü—Ä–µ—Ñ–∏–∫—Å endpoints –¥–ª—è —Ñ–æ—Ä–º—ã 6406
–í—Å–µ endpoints –≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/api/v1/report-6406`.

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–æ—Ä–º –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ (6406, 3462, –ö–†–û–° –∏ –¥—Ä.)
- –ö–∞–∂–¥–∞—è —Ñ–æ—Ä–º–∞ –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∏ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è –ø–æ —Ñ–æ—Ä–º–∞–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
  - –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –∫–∞–∂–¥–æ–π —Ñ–æ—Ä–º—ã
  - –£–¥–æ–±–Ω—É—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –≤ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
  - –ì–∏–±–∫–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º (–±—É–¥—É—â–∏–µ –∑–∞–¥–∞—á–∏):**
- `/api/v1/report-3462/*` - –¥–ª—è —Ñ–æ—Ä–º—ã 3462
- `/api/v1/report-kros/*` - –¥–ª—è —Ñ–æ—Ä–º—ã –ö–†–û–°

### –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è endpoints
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç `docs/api-conventions.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è endpoints
2. –í–∫–ª—é—á–∏—Ç—å –≤ –Ω–µ–≥–æ:
   - –°—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏
   - –ü—Ä–∞–≤–∏–ª–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
   - –°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é API
   - –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å

### –°—É—â–Ω–æ—Å—Ç–∏

#### 1. –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ (ReportTask)
–ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

**–ü–æ–ª—è:**
- `id` (UUID) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞–Ω–∏—è
- `createdAt` (timestamp) - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
- `branchId` (integer) - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞
- `branchName` (string) - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª–∏–∞–ª–∞ (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- `periodStart` (date) - –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏
- `periodEnd` (date) - –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏
- `accountMask` (string, nullable) - –º–∞—Å–∫–∞ —Å—á—ë—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `accountMaskSecondOrder` (string, nullable) - –º–∞—Å–∫–∞ —Å—á—ë—Ç–∞ 2-–≥–æ –ø–æ—Ä—è–¥–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `currency` (enum: 'RUB' | 'FOREIGN') - –≤–∞–ª—é—Ç–∞ (—Ä—É–±–ª—å –∏–ª–∏ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–∞—è –≤–∞–ª—é—Ç–∞)
- `format` (enum: 'TXT' | 'XLSX' | 'XML') - —Ñ–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- `reportType` (enum: 'LSOZ' | 'LSOS' | 'LSOP') - —Ç–∏–ø –æ—Ç—á—ë—Ç–∞
  - `LSOZ` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å—á–µ—Ç–∞—Ö
  - `LSOS` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—á–µ—Ç–∞—Ö. –û—Å—Ç–∞—Ç–∫–∏
  - `LSOP` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—á–µ—Ç–∞—Ö. –û–ø–µ—Ä–∞—Ü–∏–∏
- `source` (string, nullable) - –∫–æ–¥ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å—á–µ—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `status` (enum) - —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞–Ω–∏—è (–ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–°—Ç–∞—Ç—É—Å–Ω–∞—è –º–æ–¥–µ–ª—å](../report-6406-status-model.md))
  - `PENDING` - –í –æ—á–µ—Ä–µ–¥–∏
  - `IN_PROGRESS` - –í –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - `COMPLETED` - –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - `FAILED` - –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - `CANCELLED` - –û—Ç–º–µ–Ω–µ–Ω–æ
- `fileSize` (integer, nullable) - —Ä–∞–∑–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö
- `fileUrl` (string, nullable) - URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
- `errorMessage` (string, nullable) - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–µ—Å–ª–∏ status = FAILED)
- `updatedAt` (timestamp) - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–°–≤—è–∑–∏:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏ —á–µ—Ä–µ–∑ —Å–≤—è–∑—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤:**

TypeScript Enum:
```typescript
export enum ReportTaskStatus {
  PENDING = 'PENDING',
  IN_PROGRESS = 'IN_PROGRESS',
  COMPLETED = 'COMPLETED',
  FAILED = 'FAILED',
  CANCELLED = 'CANCELLED',
}
```

Zod Schema:
```typescript
import { z } from 'zod';

export const reportTaskStatusSchema = z.enum([
  'PENDING',
  'IN_PROGRESS',
  'COMPLETED',
  'FAILED',
  'CANCELLED',
]);

export type ReportTaskStatus = z.infer<typeof reportTaskStatusSchema>;
```

SQL (CHECK constraint):
```sql
CHECK (status IN ('PENDING', 'IN_PROGRESS', 'COMPLETED', 'FAILED', 'CANCELLED'))
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Å—Ç–∞—Ç—É—Å–∞–º–∏:**

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ —Å–µ—Ä–≤–∏—Å–µ:

```typescript
class ReportTaskService {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞–Ω–∏—è
  canCancel(currentStatus: ReportTaskStatus): boolean {
    return ['PENDING', 'IN_PROGRESS'].includes(currentStatus);
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
  canDelete(currentStatus: ReportTaskStatus): boolean {
    return currentStatus !== 'IN_PROGRESS';
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø–∞–∫–µ—Ç
  canAddToPackage(currentStatus: ReportTaskStatus): boolean {
    return currentStatus === 'COMPLETED';
  }

  // –û—Ç–º–µ–Ω–∞ –∑–∞–¥–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  async cancelTask(taskId: string): Promise<void> {
    const task = await this.getTask(taskId);
    
    if (!this.canCancel(task.status)) {
      throw new ConflictError(
        `Cannot cancel task in ${task.status} status`
      );
    }

    // –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ - –ø—Ä–µ—Ä–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
    if (task.status === 'IN_PROGRESS') {
      await this.interruptGeneration(taskId);
    }

    await this.updateTaskStatus(taskId, 'CANCELLED');
  }

  // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  async deleteTask(taskId: string): Promise<void> {
    const task = await this.getTask(taskId);
    
    if (!this.canDelete(task.status)) {
      throw new ConflictError(
        `Cannot delete task in ${task.status} status`
      );
    }

    // –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –µ—Å–ª–∏ –µ—Å—Ç—å
    if (task.fileUrl) {
      await this.deleteFile(task.fileUrl);
    }

    await this.deleteTaskFromDb(taskId);
  }
}
```

#### 2. –ü–∞–∫–µ—Ç –∑–∞–¥–∞–Ω–∏–π (ReportPackage)
–ì—Ä—É–ø–ø–∞ –∑–∞–¥–∞–Ω–∏–π, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¢–§–†.

**–ü–æ–ª—è:**
- `id` (UUID) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–∫–µ—Ç–∞
- `name` (string) - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (–¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤)
- `createdAt` (timestamp) - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–∫–µ—Ç–∞
- `createdBy` (string) - –§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –ø–∞–∫–µ—Ç
- `lastCopiedToTfrAt` (timestamp, nullable) - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¢–§–†
- `tasksCount` (integer) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π –≤ –ø–∞–∫–µ—Ç–µ (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
- `totalSize` (bigint) - –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–∫–µ—Ç–µ –≤ –±–∞–π—Ç–∞—Ö (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
- `updatedAt` (timestamp) - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–°–≤—è–∑–∏:**
- –°–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π —á–µ—Ä–µ–∑ —Å–≤—è–∑—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É

#### 3. –°–≤—è–∑—å –∑–∞–¥–∞–Ω–∏—è —Å –ø–∞–∫–µ—Ç–æ–º (PackageTask)
–°–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ many-to-many –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ –∏ –∑–∞–¥–∞–Ω–∏—è–º–∏.

**–ü–æ–ª—è:**
- `packageId` (UUID, FK) - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–∫–µ—Ç–∞
- `taskId` (UUID, FK) - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞–Ω–∏—è
- `addedAt` (timestamp) - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤ –ø–∞–∫–µ—Ç

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞ (packageId, taskId)
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞–∫–µ—Ç–∞ –∏–ª–∏ –∑–∞–¥–∞–Ω–∏—è

## API Endpoints

**–í–∞–∂–Ω–æ:** –í—Å–µ endpoints –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/api/v1/report-6406`

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

#### GET /api/v1/report-6406/references/branches
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è.

**Response 200:**
```json
{
  "branches": [
    {
      "id": 1,
      "code": "7701",
      "name": "–§–∏–ª–∏–∞–ª ‚Ññ 7701 –ë–∞–Ω–∫–∞ –í–¢–ë (–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ)"
    }
  ]
}
```

#### GET /api/v1/report-6406/references/report-types
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –æ—Ç—á—ë—Ç–æ–≤.

**Response 200:**
```json
{
  "reportTypes": [
    {
      "code": "LSOZ",
      "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å—á–µ—Ç–∞—Ö"
    },
    {
      "code": "LSOS",
      "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—á–µ—Ç–∞—Ö. –û—Å—Ç–∞—Ç–∫–∏"
    },
    {
      "code": "LSOP",
      "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—á–µ—Ç–∞—Ö. –û–ø–µ—Ä–∞—Ü–∏–∏"
    }
  ]
}
```

#### GET /api/v1/report-6406/references/currencies
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç.

**Response 200:**
```json
{
  "currencies": [
    {
      "code": "RUB",
      "name": "–†—É–±–ª—å"
    },
    {
      "code": "FOREIGN",
      "name": "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–∞—è –≤–∞–ª—é—Ç–∞"
    }
  ]
}
```

#### GET /api/v1/report-6406/references/formats
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤.

**Response 200:**
```json
{
  "formats": [
    {
      "code": "TXT",
      "name": "–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª"
    },
    {
      "code": "XLSX",
      "name": "Excel —Ñ–∞–π–ª"
    },
    {
      "code": "XML",
      "name": "XML —Ñ–∞–π–ª"
    }
  ]
}
```

#### GET /api/v1/report-6406/references/sources
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å—á–µ—Ç–æ–≤.

**Response 200:**
```json
{
  "sources": [
    {
      "code": "SRC001",
      "name": "–ò—Å—Ç–æ—á–Ω–∏–∫ 1",
      "ris": "RIS001"
    }
  ]
}
```

### –ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤

#### POST /api/v1/report-6406/tasks
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞.

**Request Body:**
```json
{
  "branchId": 7701,
  "periodStart": "2000-01-01",
  "periodEnd": "2030-12-31",
  "accountMask": "40817",
  "accountMaskSecondOrder": "01",
  "currency": "RUB",
  "format": "TXT",
  "reportType": "LSOZ",
  "source": "SRC001"
}
```

**Validation:**
- `branchId` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ > 0
- `periodStart` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- `periodEnd` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å >= periodStart
- `accountMask` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, —Å—Ç—Ä–æ–∫–∞ –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤
- `accountMaskSecondOrder` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, —Å—Ç—Ä–æ–∫–∞ –¥–æ 2 —Å–∏–º–≤–æ–ª–æ–≤
- `currency` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, enum ['RUB', 'FOREIGN']
- `format` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, enum ['TXT', 'XLSX', 'XML']
- `reportType` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, enum ['LSOZ', 'LSOS', 'LSOP']
- `source` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, —Å—Ç—Ä–æ–∫–∞ –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤

**Response 201:**
```json
{
  "id": "03cb0f48-1234-5678-9abc-def012345678",
  "createdAt": "2025-11-11T17:22:10Z",
  "branchId": 7701,
  "branchName": "–§–∏–ª–∏–∞–ª ‚Ññ 7701 –ë–∞–Ω–∫–∞ –í–¢–ë (–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ)",
  "periodStart": "2000-01-01",
  "periodEnd": "2030-12-31",
  "accountMask": "40817",
  "accountMaskSecondOrder": "01",
  "currency": "RUB",
  "format": "TXT",
  "reportType": "LSOZ",
  "source": "SRC001",
  "status": "PENDING",
  "fileSize": null,
  "fileUrl": null,
  "errorMessage": null,
  "updatedAt": "2025-11-11T17:22:10Z"
}
```

#### GET /api/v1/report-6406/tasks
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π.

**Query Parameters:**
- `page` (integer, default: 0) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞—è —Å 0)
- `limit` (integer, default: 20, max: 100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `sortBy` (string, default: 'createdAt') - –ø–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ['createdAt', 'branchId', 'status', 'periodStart']
- `sortOrder` (string, default: 'DESC') - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ['ASC', 'DESC']
- `status` (string[], optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)
- `branchId` (integer, optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ñ–∏–ª–∏–∞–ª—É
- `reportType` (string[], optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø–∞–º –æ—Ç—á—ë—Ç–æ–≤
- `periodStartFrom` (date, optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –Ω–∞—á–∞–ª—É –ø–µ—Ä–∏–æ–¥–∞ (–æ—Ç)
- `periodStartTo` (date, optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –Ω–∞—á–∞–ª—É –ø–µ—Ä–∏–æ–¥–∞ (–¥–æ)

**Response 200:**
```json
{
  "tasks": [
    {
      "id": "03cb0f48-1234-5678-9abc-def012345678",
      "createdAt": "2025-11-11T17:22:10Z",
      "branchId": 7701,
      "branchName": "–§–∏–ª–∏–∞–ª ‚Ññ 7701 –ë–∞–Ω–∫–∞ –í–¢–ë (–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ)",
      "periodStart": "2000-01-01",
      "periodEnd": "2030-12-31",
      "status": "COMPLETED",
      "fileSize": 34603008,
      "format": "TXT",
      "reportType": "LSOZ",
      "updatedAt": "2025-11-11T17:25:30Z"
    }
  ],
  "pagination": {
    "page": 0,
    "limit": 20,
    "totalItems": 256,
    "totalPages": 13
  }
}
```

#### GET /api/v1/report-6406/tasks/:id
–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–∞–Ω–∏–∏.

**Response 200:**
```json
{
  "id": "03cb0f48-1234-5678-9abc-def012345678",
  "createdAt": "2025-11-11T17:22:10Z",
  "branchId": 7701,
  "branchName": "–§–∏–ª–∏–∞–ª ‚Ññ 7701 –ë–∞–Ω–∫–∞ –í–¢–ë (–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ)",
  "periodStart": "2000-01-01",
  "periodEnd": "2030-12-31",
  "accountMask": "40817",
  "accountMaskSecondOrder": "01",
  "currency": "RUB",
  "format": "TXT",
  "reportType": "LSOZ",
  "source": "SRC001",
  "status": "COMPLETED",
  "fileSize": 34603008,
  "fileUrl": "https://storage.example.com/reports/03cb0f48-1234-5678-9abc-def012345678.txt",
  "errorMessage": null,
  "updatedAt": "2025-11-11T17:25:30Z",
  "packages": [
    {
      "id": "12312341451-uuid",
      "name": "–ö–∞–∫–æ–µ-—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞",
      "addedAt": "2025-11-11T18:00:00Z"
    }
  ]
}
```

**Response 404:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.4",
  "title": "Not Found",
  "status": 404,
  "detail": "Report task with id '03cb0f48-1234-5678-9abc-def012345678' not found"
}
```

#### DELETE /api/v1/report-6406/tasks/:id
–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ. –ï—Å–ª–∏ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å–µ IN_PROGRESS, –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É 409.

**Response 204:** (—É—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ, –±–µ–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞)

**Response 404:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.4",
  "title": "Not Found",
  "status": 404,
  "detail": "Report task with id '03cb0f48-1234-5678-9abc-def012345678' not found"
}
```

**Response 409:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.8",
  "title": "Conflict",
  "status": 409,
  "detail": "Cannot delete task in IN_PROGRESS status"
}
```

#### POST /api/v1/report-6406/tasks/bulk-delete
–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π.

**Request Body:**
```json
{
  "taskIds": [
    "03cb0f48-1234-5678-9abc-def012345678",
    "03cb0f48-1234-5678-9abc-def012345679"
  ]
}
```

**Response 200:**
```json
{
  "deleted": 2,
  "failed": 0,
  "errors": []
}
```

**Response 200 (—á–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö):**
```json
{
  "deleted": 1,
  "failed": 1,
  "errors": [
    {
      "taskId": "03cb0f48-1234-5678-9abc-def012345679",
      "reason": "Cannot delete task in IN_PROGRESS status"
    }
  ]
}
```

#### POST /api/v1/report-6406/tasks/:id/cancel
–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ (–ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —Å—Ç–∞—Ç—É—Å CANCELLED). –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π –≤ —Å—Ç–∞—Ç—É—Å–µ PENDING –∏–ª–∏ IN_PROGRESS.

**Response 200:**
```json
{
  "id": "03cb0f48-1234-5678-9abc-def012345678",
  "status": "CANCELLED",
  "updatedAt": "2025-11-11T18:30:00Z"
}
```

**Response 409:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.8",
  "title": "Conflict",
  "status": 409,
  "detail": "Cannot cancel task in COMPLETED status"
}
```

#### POST /api/v1/report-6406/tasks/bulk-cancel
–ú–∞—Å—Å–æ–≤–∞—è –æ—Ç–º–µ–Ω–∞ –∑–∞–¥–∞–Ω–∏–π.

**Request Body:**
```json
{
  "taskIds": [
    "03cb0f48-1234-5678-9abc-def012345678",
    "03cb0f48-1234-5678-9abc-def012345679"
  ]
}
```

**Response 200:**
```json
{
  "cancelled": 2,
  "failed": 0,
  "errors": []
}
```

### –ü–∞–∫–µ—Ç—ã –∑–∞–¥–∞–Ω–∏–π

#### POST /api/v1/report-6406/packages
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç.

**Request Body:**
```json
{
  "name": "–ö–∞–∫–æ–µ-—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞",
  "createdBy": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
}
```

**Validation:**
- `name` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, —Å—Ç—Ä–æ–∫–∞ –æ—Ç 1 –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
- `createdBy` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, —Å—Ç—Ä–æ–∫–∞ –æ—Ç 1 –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤

**Response 201:**
```json
{
  "id": "12312341451-uuid",
  "name": "–ö–∞–∫–æ–µ-—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞",
  "createdAt": "2025-12-21T14:33:45Z",
  "createdBy": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
  "lastCopiedToTfrAt": null,
  "tasksCount": 0,
  "totalSize": 0,
  "updatedAt": "2025-12-21T14:33:45Z"
}
```

#### GET /api/v1/report-6406/packages
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π.

**Query Parameters:**
- `page` (integer, default: 0) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` (integer, default: 20, max: 100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `sortBy` (string, default: 'createdAt') - –ø–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ['createdAt', 'name', 'tasksCount', 'totalSize']
- `sortOrder` (string, default: 'DESC') - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ['ASC', 'DESC']
- `search` (string, optional) - –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø–∞–∫–µ—Ç–∞ (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)

**Response 200:**
```json
{
  "packages": [
    {
      "id": "12312341451-uuid",
      "name": "–ö–∞–∫–æ–µ-—Ç–æ –≤–∞–ª–∏–¥–Ω–æ–µ –∏–º—è –ø–∞–∫–µ—Ç–∞",
      "createdAt": "2025-12-21T14:33:45Z",
      "createdBy": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
      "lastCopiedToTfrAt": "2025-12-21T14:33:45Z",
      "tasksCount": 10123,
      "totalSize": 128974848
    }
  ],
  "pagination": {
    "page": 0,
    "limit": 20,
    "totalItems": 256,
    "totalPages": 13
  }
}
```

#### GET /api/v1/report-6406/packages/:id
–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞–∫–µ—Ç–µ, –≤–∫–ª—é—á–∞—è —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π –≤ –ø–∞–∫–µ—Ç–µ.

**Query Parameters (–¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π –≤–Ω—É—Ç—Ä–∏ –ø–∞–∫–µ—Ç–∞):**
- `tasksPage` (integer, default: 0) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∑–∞–¥–∞–Ω–∏–π
- `tasksLimit` (integer, default: 20, max: 100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `tasksSortBy` (string, default: 'createdAt') - –ø–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∑–∞–¥–∞–Ω–∏–π
- `tasksSortOrder` (string, default: 'DESC') - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∑–∞–¥–∞–Ω–∏–π

**Response 200:**
```json
{
  "id": "12312341451-uuid",
  "name": "–ö–∞–∫–æ–µ-—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞",
  "createdAt": "2025-12-21T14:33:45Z",
  "createdBy": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
  "lastCopiedToTfrAt": "2025-12-21T14:33:45Z",
  "tasksCount": 10123,
  "totalSize": 128974848,
  "updatedAt": "2025-12-21T14:33:45Z",
  "tasks": [
    {
      "id": "03cb0f48-1234-5678-9abc-def012345678",
      "createdAt": "2025-11-11T17:22:10Z",
      "branchId": 7701,
      "branchName": "–§–∏–ª–∏–∞–ª ‚Ññ 7701 –ë–∞–Ω–∫–∞ –í–¢–ë (–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ)",
      "periodStart": "2000-01-01",
      "periodEnd": "2030-12-31",
      "status": "COMPLETED",
      "fileSize": 34603008,
      "format": "TXT",
      "addedAt": "2025-11-11T18:00:00Z"
    }
  ],
  "tasksPagination": {
    "page": 0,
    "limit": 20,
    "totalItems": 256,
    "totalPages": 13
  }
}
```

#### PATCH /api/v1/report-6406/packages/:id
–û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞.

**Request Body:**
```json
{
  "name": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞"
}
```

**Response 200:**
```json
{
  "id": "12312341451-uuid",
  "name": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞",
  "updatedAt": "2025-12-21T15:00:00Z"
}
```

#### DELETE /api/v1/report-6406/packages/:id
–£–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞–∫–µ—Ç–∞ –≤—Å–µ —Å–≤—è–∑–∏ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ —É–¥–∞–ª—è—é—Ç—Å—è, –Ω–æ —Å–∞–º–∏ –∑–∞–¥–∞–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è.

**Response 204:** (—É—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ, –±–µ–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞)

**Response 404:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.4",
  "title": "Not Found",
  "status": 404,
  "detail": "Package with id '12312341451-uuid' not found"
}
```

#### POST /api/v1/report-6406/packages/bulk-delete
–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤.

**Request Body:**
```json
{
  "packageIds": [
    "12312341451-uuid",
    "12312341452-uuid"
  ]
}
```

**Response 200:**
```json
{
  "deleted": 2,
  "failed": 0,
  "errors": []
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö

#### POST /api/v1/report-6406/packages/:packageId/tasks
–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –≤ –ø–∞–∫–µ—Ç.

**Request Body:**
```json
{
  "taskIds": [
    "03cb0f48-1234-5678-9abc-def012345678",
    "03cb0f48-1234-5678-9abc-def012345679"
  ]
}
```

**Validation:**
- `taskIds` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –º–∞—Å—Å–∏–≤ UUID, –º–∏–Ω–∏–º—É–º 1 —ç–ª–µ–º–µ–Ω—Ç

**Response 200:**
```json
{
  "added": 2,
  "alreadyInPackage": 0,
  "notFound": 0,
  "errors": []
}
```

**Response 200 (—á–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö):**
```json
{
  "added": 1,
  "alreadyInPackage": 1,
  "notFound": 0,
  "errors": [
    {
      "taskId": "03cb0f48-1234-5678-9abc-def012345679",
      "reason": "Task already in package"
    }
  ]
}
```

#### DELETE /api/v1/report-6406/packages/:packageId/tasks/:taskId
–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –∏–∑ –ø–∞–∫–µ—Ç–∞.

**Response 204:** (—É—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ, –±–µ–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞)

**Response 404:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.4",
  "title": "Not Found",
  "status": 404,
  "detail": "Task '03cb0f48-1234-5678-9abc-def012345678' not found in package '12312341451-uuid'"
}
```

#### POST /api/v1/report-6406/packages/:packageId/tasks/bulk-remove
–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –∏–∑ –ø–∞–∫–µ—Ç–∞.

**Request Body:**
```json
{
  "taskIds": [
    "03cb0f48-1234-5678-9abc-def012345678",
    "03cb0f48-1234-5678-9abc-def012345679"
  ]
}
```

**Response 200:**
```json
{
  "removed": 2,
  "notFound": 0,
  "errors": []
}
```

#### POST /api/v1/report-6406/packages/:packageId/copy-to-tfr
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –≤ –¢–§–† (–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω—ã–π –§–∏–ª–∏–∞–ª –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏). –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª–µ `lastCopiedToTfrAt`.

**Response 200:**
```json
{
  "id": "12312341451-uuid",
  "lastCopiedToTfrAt": "2025-12-21T15:30:00Z",
  "message": "Package successfully copied to TFR"
}
```

**Response 400:**
```json
{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
  "title": "Bad Request",
  "status": 400,
  "detail": "Cannot copy empty package to TFR"
}
```

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–í–∞–∂–Ω–æ:** –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–µ—Ñ–∏–∫—Å `report_6406_` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏.

### –¢–∞–±–ª–∏—Ü–∞: report_6406_tasks

```sql
CREATE TABLE report_6406_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  created_at TIMESTAMP NOT NULL DEFAULT NOW(),
  branch_id INTEGER NOT NULL,
  branch_name VARCHAR(255) NOT NULL,
  period_start DATE NOT NULL,
  period_end DATE NOT NULL,
  account_mask VARCHAR(20),
  account_mask_second_order VARCHAR(2),
  currency VARCHAR(20) NOT NULL CHECK (currency IN ('RUB', 'FOREIGN')),
  format VARCHAR(10) NOT NULL CHECK (format IN ('TXT', 'XLSX', 'XML')),
  report_type VARCHAR(10) NOT NULL CHECK (report_type IN ('LSOZ', 'LSOS', 'LSOP')),
  source VARCHAR(20),
  status VARCHAR(20) NOT NULL DEFAULT 'PENDING' CHECK (status IN ('PENDING', 'IN_PROGRESS', 'COMPLETED', 'FAILED', 'CANCELLED')),
  file_size BIGINT,
  file_url TEXT,
  error_message TEXT,
  updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_report_6406_tasks_created_at ON report_6406_tasks(created_at DESC);
CREATE INDEX idx_report_6406_tasks_branch_id ON report_6406_tasks(branch_id);
CREATE INDEX idx_report_6406_tasks_status ON report_6406_tasks(status);
CREATE INDEX idx_report_6406_tasks_period_start ON report_6406_tasks(period_start);
```

### –¢–∞–±–ª–∏—Ü–∞: report_6406_packages

```sql
CREATE TABLE report_6406_packages (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT NOW(),
  created_by VARCHAR(255) NOT NULL,
  last_copied_to_tfr_at TIMESTAMP,
  tasks_count INTEGER NOT NULL DEFAULT 0,
  total_size BIGINT NOT NULL DEFAULT 0,
  updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_report_6406_packages_created_at ON report_6406_packages(created_at DESC);
CREATE INDEX idx_report_6406_packages_name ON report_6406_packages(name);
```

### –¢–∞–±–ª–∏—Ü–∞: report_6406_package_tasks (—Å–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞)

```sql
CREATE TABLE report_6406_package_tasks (
  package_id UUID NOT NULL REFERENCES report_6406_packages(id) ON DELETE CASCADE,
  task_id UUID NOT NULL REFERENCES report_6406_tasks(id) ON DELETE CASCADE,
  added_at TIMESTAMP NOT NULL DEFAULT NOW(),
  PRIMARY KEY (package_id, task_id)
);

CREATE INDEX idx_report_6406_package_tasks_package_id ON report_6406_package_tasks(package_id);
CREATE INDEX idx_report_6406_package_tasks_task_id ON report_6406_package_tasks(task_id);
```

### –¢–∞–±–ª–∏—Ü–∞: branches (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤)

```sql
CREATE TABLE branches (
  id INTEGER PRIMARY KEY,
  code VARCHAR(10) NOT NULL UNIQUE,
  name VARCHAR(255) NOT NULL
);

CREATE INDEX idx_branches_code ON branches(code);
```

### –¢–∞–±–ª–∏—Ü–∞: sources (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

```sql
CREATE TABLE sources (
  code VARCHAR(20) PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  ris VARCHAR(20)
);
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/be/src
  /db
    /schema
      report-6406-tasks.schema.ts      # –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã report_6406_tasks
      report-6406-packages.schema.ts   # –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã report_6406_packages
      report-6406-package-tasks.schema.ts  # –°—Ö–µ–º–∞ —Å–≤—è–∑—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã
      branches.schema.ts               # –°—Ö–µ–º–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Ñ–∏–ª–∏–∞–ª–æ–≤
      sources.schema.ts                # –°—Ö–µ–º–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
      index.ts                         # –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å—Ö–µ–º
  /routes
    /v1
      /report-6406
        /tasks
          index.ts                # CRUD –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∑–∞–¥–∞–Ω–∏–π
          bulk-operations.ts      # –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (bulk-delete, bulk-cancel)
        /packages
          index.ts                # CRUD –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤
          tasks.ts                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö
        /references
          index.ts                # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
        index.ts                  # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö report-6406 –º–∞—Ä—à—Ä—É—Ç–æ–≤
      index.ts                    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö v1 –º–∞—Ä—à—Ä—É—Ç–æ–≤
  /services
    /report-6406
      tasks.service.ts            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π
      packages.service.ts         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤
      references.service.ts       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
  /schemas
    /report-6406
      tasks.schema.ts             # Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API –∑–∞–¥–∞–Ω–∏–π
      packages.schema.ts          # Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API –ø–∞–∫–µ—Ç–æ–≤
      references.schema.ts        # Zod —Å—Ö–µ–º—ã –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
    common.schema.ts              # –û–±—â–∏–µ —Å—Ö–µ–º—ã (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –°–æ–∑–¥–∞–Ω—ã Drizzle —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü (report_6406_tasks, report_6406_packages, report_6406_package_tasks, branches, sources)
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –°–æ–∑–¥–∞–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–∞—Å–∫–∞–¥–Ω—ã–µ —É–¥–∞–ª–µ–Ω–∏—è –¥–ª—è —Å–≤—è–∑—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã

### API Endpoints - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
- [ ] GET /api/v1/report-6406/references/branches - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª–∏–∞–ª–æ–≤
- [ ] GET /api/v1/report-6406/references/report-types - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –æ—Ç—á—ë—Ç–æ–≤
- [ ] GET /api/v1/report-6406/references/currencies - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç
- [ ] GET /api/v1/report-6406/references/formats - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤
- [ ] GET /api/v1/report-6406/references/sources - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### API Endpoints - –ó–∞–¥–∞–Ω–∏—è
- [ ] POST /api/v1/report-6406/tasks - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- [ ] GET /api/v1/report-6406/tasks - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- [ ] GET /api/v1/report-6406/tasks/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- [ ] DELETE /api/v1/report-6406/tasks/:id - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- [ ] POST /api/v1/report-6406/tasks/bulk-delete - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- [ ] POST /api/v1/report-6406/tasks/:id/cancel - –æ—Ç–º–µ–Ω–∞ –∑–∞–¥–∞–Ω–∏—è
- [ ] POST /api/v1/report-6406/tasks/bulk-cancel - –º–∞—Å—Å–æ–≤–∞—è –æ—Ç–º–µ–Ω–∞

### API Endpoints - –ü–∞–∫–µ—Ç—ã
- [ ] POST /api/v1/report-6406/packages - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
- [ ] GET /api/v1/report-6406/packages - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- [ ] GET /api/v1/report-6406/packages/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏
- [ ] PATCH /api/v1/report-6406/packages/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- [ ] DELETE /api/v1/report-6406/packages/:id - —É–¥–∞–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
- [ ] POST /api/v1/report-6406/packages/bulk-delete - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

### API Endpoints - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö
- [ ] POST /api/v1/report-6406/packages/:packageId/tasks - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –≤ –ø–∞–∫–µ—Ç
- [ ] DELETE /api/v1/report-6406/packages/:packageId/tasks/:taskId - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏–∑ –ø–∞–∫–µ—Ç–∞
- [ ] POST /api/v1/report-6406/packages/:packageId/tasks/bulk-remove - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ø–∞–∫–µ—Ç–∞
- [ ] POST /api/v1/report-6406/packages/:packageId/copy-to-tfr - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –¢–§–†

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—ã
- [ ] –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º RFC 7807
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞—Ç—É—Å–Ω–æ–π –º–æ–¥–µ–ª–∏:
  - [ ] –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ IN_PROGRESS
  - [ ] –ù–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ COMPLETED, FAILED –∏–ª–∏ CANCELLED
  - [ ] –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–∫–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ COMPLETED
- [ ] –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤ (409 Conflict –¥–ª—è –Ω–∞—Ä—É—à–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å—Ç–∞—Ç—É—Å–∞–º–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞—Ç—É—Å–Ω–æ–π –º–æ–¥–µ–ª–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏: canCancel(), canDelete(), canAddToPackage()

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤
- [ ] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Å–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–æ–ª—è–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–æ–ª—è–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è (tasksCount, totalSize) –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ü–æ–ª–µ updatedAt –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–µ–π
- [ ] –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ø–µ—Ö–∞—Ö –∏ –æ—à–∏–±–∫–∞—Ö

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ /docs
- [ ] –í—Å–µ endpoints –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Swagger —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /api/v1/report-6406
- [ ] –í—Å–µ —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç docs/api-conventions.md —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è endpoints

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –í—Å–µ endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ Swagger UI
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (–ø—É—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏, –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ID –∏ —Ç.–¥.)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–æ–ª–µ–π tasksCount –∏ totalSize –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è COUNT –∑–∞–ø—Ä–æ—Å–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è JOIN –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –æ—Ç SQL injection —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ Drizzle
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (max: 100)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É `feature/TASK-003-implement-6406-report-api` –æ—Ç `main`
2. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è report-6406 –≤ routes, services, schemas
3. –°–æ–∑–¥–∞—Ç—å Drizzle —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü (—Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º report_6406_)
4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
5. –°–æ–∑–¥–∞—Ç—å Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (services/report-6406/references.service.ts)
7. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /api/v1/report-6406/references
8. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∑–∞–¥–∞–Ω–∏–π (services/report-6406/tasks.service.ts)
9. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∑–∞–¥–∞–Ω–∏–π —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /api/v1/report-6406/tasks (CRUD + –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
10. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤ (services/report-6406/packages.service.ts)
11. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /api/v1/report-6406/packages (CRUD + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏)
12. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints —á–µ—Ä–µ–∑ Swagger UI
13. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
14. –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç docs/api-conventions.md —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è endpoints
15. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
16. –°–æ–∑–¥–∞—Ç—å seed —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
17. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º: `TASK-003 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API –¥–ª—è —Ñ–æ—Ä–º—ã –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ 6406`

## –í–µ—Ç–∫–∞
`feature/TASK-003-implement-6406-report-api`

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: TASK-002 (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Backend –ø—Ä–æ–µ–∫—Ç–∞)

## –°—Å—ã–ª–∫–∏
- [–°—Ç–∞—Ç—É—Å–Ω–∞—è –º–æ–¥–µ–ª—å —Ñ–æ—Ä–º—ã 6406](../report-6406-status-model.md)
- [API Conventions](../api-conventions.md)
- –£—Å—Ç–∞—Ä–µ–≤—à–∞—è Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: `docs/rawData/2026-01-27/reportService.json`
- UI —Å–∫—Ä–∏–Ω—à–æ—Ç—ã: `docs/rawData/2026-01-27/*.png`
- Drizzle ORM –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://orm.drizzle.team/
- RFC 7807 Problem Details: https://tools.ietf.org/html/rfc7807

## –£—Ç–æ—á–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

_(–≠—Ç–∞ —Å–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –∑–∞–¥–∞–Ω–∏–µ–º)_
