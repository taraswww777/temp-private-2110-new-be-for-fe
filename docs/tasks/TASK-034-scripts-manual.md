# TASK-034: Добавление мануала по работе со скриптами API и моков

**Статус**: ✅ Завершено  
**Ветка**: `feature/TASK-034-scripts-manual`

---

## Краткое описание

Создать краткий мануал по использованию скриптов для работы с API клиентами и мок данными. Документация должна описывать, когда и какие скрипты нужно вызывать, с примерами типичных кейсов использования.

---

## Контекст

В проекте существует множество скриптов для работы с API и моками:
- `api:fullUpdate` / `api:fullUpdate2` — полное обновление API
- `api:item:*:update` — обновление Swagger JSON
- `api:item:*:gen` — генерация TypeScript клиента
- `api:item:*:fix` — исправление сгенерированного клиента
- `api:item:*:gen_fix` — генерация и исправление
- `generateMockData` / `generateMockData2` — генерация мок данных

Разобраться в назначении каждого скрипта и последовательности их вызова непросто. Необходимо создать понятный мануал с примерами кейсов использования.

---

## Требования

### Документация

1. **Создать документ `docs/scripts-manual.md`** с описанием:
   - Назначение каждого скрипта
   - Последовательность выполнения скриптов
   - Типичные кейсы использования

2. **Описать структуру скриптов:**
   - **update** — обновление Swagger JSON из удаленного источника
   - **gen** — генерация TypeScript клиента из Swagger JSON
   - **fix** — исправление сгенерированного клиента (типы, импорты)
   - **gen_fix** — комбинация gen + fix
   - **fullUpdate** — полный цикл: update + gen_fix

3. **Описать работу с мок данными:**
   - Генерация моков на основе типов из API клиента
   - Структура папок `apiMock2/generated` и `apiMock2/predefined`
   - Как добавить предопределенные данные
   - Как перегенерировать моки после изменения типов

4. **Создать кейсы использования:**

   **Кейс 1: Изменение DTO сущности в Swagger и обновление клиента**
   - Описание: Backend изменил структуру DTO в Swagger
   - Шаги:
     1. Запустить `api:item:apiService2110:update` для обновления Swagger JSON
     2. Запустить `api:item:apiService2110:gen_fix` для генерации нового клиента
     3. Проверить изменения в `apiClient2/api/service2110/models/`
     4. Обновить код, использующий измененные типы
     5. При необходимости перегенерировать моки: `generateMockData2`

   **Кейс 2: Добавление нового эндпоинта в Swagger**
   - Описание: Backend добавил новый эндпоинт в Swagger
   - Шаги:
     1. Запустить `api:fullUpdate2` (update + gen_fix)
     2. Проверить новый сервис/метод в `apiClient2/api/service2110/services/`
     3. Использовать новый метод в коде
     4. Добавить handler для моков в `webpackConfigs/devServer/handlers/api2/`
     5. Перегенерировать моки: `generateMockData2`

   **Кейс 3: Изменение структуры мок данных**
   - Описание: Нужно изменить структуру генерируемых моков
   - Шаги:
     1. Изменить генератор в `scripts/generateMockData2/generators/`
     2. Запустить `generateMockData2`
     3. Проверить изменения в `apiMock2/generated/`

   **Кейс 4: Добавление предопределенных мок данных**
   - Описание: Нужно добавить конкретные данные для тестирования
   - Шаги:
     1. Открыть `apiMock2/predefined.ts`
     2. Добавить данные в соответствующий раздел (например, `predefined.tasksList`)
     3. Запустить `generateMockData2` (предопределенные данные будут объединены с сгенерированными)
     4. Проверить результат в `apiMock2/generated/`

   **Кейс 5: Полное обновление API после изменений в Backend**
   - Описание: Backend обновил Swagger, нужно синхронизировать фронтенд
   - Шаги:
     1. Запустить `api:fullUpdate2` (обновит Swagger, сгенерирует клиент, исправит его)
     2. Проверить breaking changes в типах
     3. Обновить код, использующий измененные типы
     4. Обновить генераторы моков при необходимости
     5. Перегенерировать моки: `generateMockData2`

   **Кейс 6: Исправление ошибок в сгенерированном клиенте**
   - Описание: После генерации клиента возникли ошибки типов или импортов
   - Шаги:
     1. Запустить `api:item:apiService2110:fix` для применения исправлений
     2. Если ошибки остались, проверить скрипт `scripts/swagger/fixClientApi/fixClientApi2.ts`
     3. При необходимости добавить новые исправления в скрипт

5. **Добавить справочную таблицу скриптов:**

| Скрипт | Назначение | Когда использовать |
|--------|------------|-------------------|
| `api:fullUpdate2` | Полное обновление API2 (update + gen + fix) | После изменений в Swagger Backend |
| `api:item:apiService2110:update` | Обновление Swagger JSON из удаленного источника | Когда нужно только обновить Swagger |
| `api:item:apiService2110:gen` | Генерация TypeScript клиента из Swagger | После обновления Swagger JSON |
| `api:item:apiService2110:fix` | Исправление сгенерированного клиента | После генерации клиента |
| `api:item:apiService2110:api:gen_fix` | Генерация и исправление (gen + fix) | После обновления Swagger |
| `generateMockData2` | Генерация мок данных для API2 | После изменения типов или генераторов |

6. **Описать структуру файлов и папок:**
   - `docs/apiDocs/service2110.json` — Swagger спецификация
   - `apiClient2/api/service2110/` — сгенерированный TypeScript клиент
   - `apiMock2/generated/` — сгенерированные мок данные
   - `apiMock2/predefined.ts` — предопределенные мок данные
   - `scripts/generateMockData2/generators/` — генераторы моков

---

## Критерии приёмки

- [x] Создан документ `docs/scripts-manual.md` с описанием всех скриптов
- [x] Описана структура скриптов (update, gen, fix, gen_fix, fullUpdate)
- [x] Описана работа с мок данными (generated, predefined)
- [x] Добавлено минимум 6 кейсов использования с пошаговыми инструкциями
- [x] Добавлена справочная таблица скриптов
- [x] Описана структура файлов и папок
- [x] Документация понятна и может быть использована новыми разработчиками
- [x] Документация добавлена в README или указана ссылка на неё

---

## Область изменений

| Файл | Описание |
|------|----------|
| `docs/scripts-manual.md` | Новый документ с мануалом по скриптам |
| `temp-private-2110/README.md` | Добавление ссылки на мануал (опционально) |

---

## Вне границ данной задачи

- Изменение самих скриптов
- Добавление новых скриптов
- Изменение структуры генераторов моков
- Изменение структуры API клиентов

---

## Дополнительные заметки

### Структура документации

Рекомендуемая структура `docs/scripts-manual.md`:

1. **Введение**
   - Назначение документации
   - Обзор скриптов

2. **Структура скриптов**
   - Описание каждого типа скрипта
   - Последовательность выполнения

3. **Справочная таблица скриптов**
   - Таблица со всеми скриптами и их назначением

4. **Кейсы использования**
   - Кейс 1: Изменение DTO сущности
   - Кейс 2: Добавление нового эндпоинта
   - Кейс 3: Изменение структуры мок данных
   - Кейс 4: Добавление предопределенных моков
   - Кейс 5: Полное обновление API
   - Кейс 6: Исправление ошибок в клиенте

5. **Работа с мок данными**
   - Структура папок
   - Генерация моков
   - Предопределенные данные
   - Обновление генераторов

6. **Структура файлов и папок**
   - Описание важных файлов и папок

### Важные моменты

1. **Разница между apiReportService и apiService2110:**
   - `apiReportService` — старый API (legacy)
   - `apiService2110` — новый API (используется в AppRouter ветке)

2. **Разница между generateMockData и generateMockData2:**
   - `generateMockData` — генерация моков для старого API
   - `generateMockData2` — генерация моков для нового API2

3. **Предопределенные данные:**
   - Данные из `apiMock2/predefined.ts` имеют приоритет над сгенерированными
   - Используются для тестирования конкретных сценариев

4. **Исправления клиента:**
   - Скрипт `fix` применяет паттерны для исправления типов и импортов
   - Может потребоваться обновление при изменении структуры Swagger

---

## Связанные задачи и артефакты

- Скрипты обновления: `temp-private-2110/scripts/run/`
- Генераторы моков: `temp-private-2110/scripts/generateMockData2/`
- API клиенты: `temp-private-2110/apiClient2/`
- Мок данные: `temp-private-2110/apiMock2/`
- Swagger спецификации: `temp-private-2110/docs/apiDocs/`
